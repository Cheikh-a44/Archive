<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Archive ISET Améliorée</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  :root {
    --primary: #0077b6;
    --primary-dark: #005f87;
    --primary-light: #caf0f8;
    --secondary: #0096c7;
    --accent: #00b4d8;
    --light: #f5f7fa;
    --white: #ffffff;
    --text: #333333;
    --text-light: #666666;
    --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    --radius: 10px;
    --transition: all 0.3s ease;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: var(--light);
    color: var(--text);
    line-height: 1.6;
  }

  header {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: var(--white);
    padding: 1.5rem 1rem;
    text-align: center;
    box-shadow: var(--shadow);
  }

  header h1 {
    font-size: 2.2rem;
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
  }

  header p {
    font-size: 1.1rem;
    opacity: 0.9;
    max-width: 600px;
    margin: 0 auto;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
  }

  /* Breadcrumb */
  #breadcrumb {
    padding: 1rem;
    background: var(--white);
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    margin-bottom: 1rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  }

  #breadcrumbContent {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  #breadcrumbContent span {
    font-weight: 600;
    cursor: pointer;
    background: var(--primary);
    color: var(--white);
    padding: 0.5rem 1rem;
    border-radius: var(--radius);
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
    user-select: none;
    transition: var(--transition);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  #breadcrumbContent span:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
  }

  #breadcrumbContent span:active {
    transform: scale(0.97);
  }

  #breadcrumbContent span i {
    font-size: 0.8rem;
  }

  /* Search Bar */
  .search-container {
    padding: 1rem;
    background: var(--white);
    border-radius: var(--radius);
    margin: 1rem;
    box-shadow: var(--shadow);
  }

  .search-box {
    display: flex;
    max-width: 600px;
    margin: 0 auto;
  }

  .search-box input {
    flex: 1;
    padding: 0.8rem 1rem;
    border: 2px solid var(--primary-light);
    border-radius: var(--radius) 0 0 var(--radius);
    font-size: 1rem;
    outline: none;
    transition: var(--transition);
  }

  .search-box input:focus {
    border-color: var(--primary);
  }

  .search-box button {
    background: var(--primary);
    color: var(--white);
    border: none;
    padding: 0 1.5rem;
    border-radius: 0 var(--radius) var(--radius) 0;
    cursor: pointer;
    transition: var(--transition);
    font-size: 1rem;
    min-width: 60px;
  }

  .search-box button:hover {
    background: var(--primary-dark);
  }

  /* Grid / Cards */
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 10px;
    padding: 20px;
  }

  .card {
    background: var(--white);
    padding: 1em;
    border-radius: var(--radius);
    text-align: center;
    cursor: pointer;
    box-shadow: var(--shadow);
    transition: var(--transition);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    min-height: 100px;
  }

  .card:hover {
    background: var(--primary-light);
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
  }

  .card:active {
    transform: scale(0.97);
  }

  .card-title {
    font-weight: 600;
    font-size: 0.9rem;
  }

  /* Sections */
  section {
    display: none;
  }

  section.active {
    display: block;
    animation: fadeIn 0.3s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* File List */
  .file-list-container {
    padding: 1rem;
  }

  .file-item {
    background: var(--white);
    margin: 0.8rem 0;
    padding: 1rem 1.5rem;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: var(--transition);
  }

  .file-item:hover {
    background: var(--primary-light);
    transform: translateX(5px);
  }

  .file-item:active {
    transform: scale(0.98);
  }

  .file-info {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .file-icon {
    font-size: 1.5rem;
    color: var(--primary);
  }

  .file-name {
    font-weight: 500;
  }

  .file-actions {
    display: flex;
    gap: 0.5rem;
  }

  .file-action {
    background: none;
    border: none;
    font-size: 1.2rem;
    cursor: pointer;
    color: var(--text-light);
    transition: var(--transition);
    padding: 0.3rem;
    border-radius: 50%;
  }

  .file-action:hover {
    color: var(--primary);
    background: rgba(0, 0, 0, 0.05);
  }

  /* Info messages */
  .info {
    text-align: center;
    color: var(--text-light);
    margin: 1.5rem 0;
    font-style: italic;
    padding: 1rem;
    background: var(--white);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
  }

  /* Empty state */
  .empty-state {
    text-align: center;
    padding: 3rem 1rem;
    color: var(--text-light);
  }

  .empty-state i {
    font-size: 3rem;
    margin-bottom: 1rem;
    color: var(--primary-light);
  }

  /* Back Button */
  .back-button {
    position: fixed;
    bottom: 20px;
    left: 20px;
    background: var(--primary);
    color: white;
    border: none;
    padding: 12px;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: var(--shadow);
    transition: var(--transition);
    z-index: 1000;
  }

  .back-button:hover {
    background: var(--primary-dark);
    transform: scale(1.1);
  }

  /* Responsive */
  @media (max-width: 768px) {
    .grid {
      grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
    }
    
    header h1 {
      font-size: 1.8rem;
    }
    
    .file-item {
      flex-direction: column;
      align-items: flex-start;
      gap: 1rem;
    }
    
    .file-actions {
      align-self: flex-end;
    }
    
    .search-box {
      max-width: 100%;
    }
  }

  @media (max-width: 480px) {
    .grid {
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    }
    
    .card {
      padding: 0.8rem 0.5rem;
    }
    
    header h1 {
      font-size: 1.6rem;
    }
    
    header p {
      font-size: 1rem;
    }
  }
</style>
</head>
<body>

<header>
  <div class="container">
    <h1><i class="fas fa-graduation-cap"></i> Archive ISET</h1>
    <p>Plateforme centralisée de ressources académiques pour les étudiants</p>
  </div>
</header>

<div class="container">
  <!-- Breadcrumb -->
  <div id="breadcrumb">
    <div id="breadcrumbContent">
      <span onclick="goHome()"><i class="fas fa-home"></i> Accueil</span>
    </div>
  </div>

  <!-- Search Bar -->
  <div class="search-container">
    <div class="search-box">
      <input type="text" id="searchInput" placeholder="Rechercher une matière (ex: Math, Physique, PPV...)">
      <button onclick="performSearch()"><i class="fas fa-search"></i></button>
    </div>
  </div>

  <!-- Back Button -->
  <button class="back-button" onclick="goBack()" style="display: none;">
    <i class="fas fa-arrow-left"></i>
  </button>

  <!-- Main Content Sections -->
  <section id="years" class="active">
    <h2 class="section-title">Sélectionnez votre année</h2>
    <div class="grid">
      <div class="card" onclick="showSectionWithBreadcrumb('semestersL1', 'L1')">
        <div class="card-title">L1</div>
      </div>
      <div class="card" onclick="showSectionWithBreadcrumb('semestersL2', 'L2')">
        <div class="card-title">L2</div>
      </div>
      <div class="card" onclick="showComingSoon('L3')">
        <div class="card-title">L3</div>
      </div>
    </div>
  </section>

  <!-- L1 Semesters -->
  <section id="semestersL1">
    <h2 class="section-title">L1 - Sélectionnez votre semestre</h2>
    <div class="grid">
      <div class="card" onclick="showSectionWithBreadcrumb('subjectsS1', 'S1')">
        <div class="card-title">S1</div>
      </div>
      <div class="card" onclick="showSectionWithBreadcrumb('subjectsS2', 'S2')">
        <div class="card-title">S2</div>
      </div>
    </div>
  </section>

  <!-- L2 Semesters -->
  <section id="semestersL2">
    <h2 class="section-title">L2 - Sélectionnez votre semestre</h2>
    <div class="grid">
      <div class="card" onclick="showSectionWithBreadcrumb('departments', 'S3')">
        <div class="card-title">S3</div>
      </div>
      <div class="card" onclick="showComingSoon('S4')">
        <div class="card-title">S4</div>
      </div>
    </div>
  </section>

  <!-- Departments Section -->
  <section id="departments">
    <h2 class="section-title">S3 - Sélectionnez votre département</h2>
    <div class="grid">
      <div class="card" onclick="selectDepartmentWithBreadcrumb('PPV')">
        <div class="card-title">PPV</div>
      </div>
      <div class="card" onclick="selectDepartmentWithBreadcrumb('GEM')">
        <div class="card-title">GEM</div>
      </div>
      <div class="card" onclick="selectDepartmentWithBreadcrumb('GAB')">
        <div class="card-title">GAB</div>
      </div>
      <div class="card" onclick="selectDepartmentWithBreadcrumb('PSA')">
        <div class="card-title">PSA</div>
      </div>
      <div class="card" onclick="selectDepartmentWithBreadcrumb('STA')">
        <div class="card-title">STA</div>
      </div>
    </div>
  </section>

  <!-- S1 Subjects -->
  <section id="subjectsS1">
    <h2 class="section-title">S1 - Sélectionnez une matière</h2>
    <div class="grid">
      <div class="card" onclick="selectSubjectWithBreadcrumb('Math', 'S1')">
        <div class="card-title">Mathématiques</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Physique', 'S1')">
        <div class="card-title">Physique</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Chimie', 'S1')">
        <div class="card-title">Chimie</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Anglais', 'S1')">
        <div class="card-title">Anglais</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Français', 'S1')">
        <div class="card-title">Français</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Biologie', 'S1')">
        <div class="card-title">Biologie</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Microbiologie', 'S1')">
        <div class="card-title">Microbiologie</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Génétique', 'S1')">
        <div class="card-title">Génétique</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Informatique', 'S1')">
        <div class="card-title">Informatique</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Statistique', 'S1')">
        <div class="card-title">Statistique</div>
      </div>
    </div>
  </section>

  <!-- S2 Subjects -->
  <section id="subjectsS2">
    <h2 class="section-title">S2 - Sélectionnez une matière</h2>
    <div class="grid">
      <div class="card" onclick="selectSubjectWithBreadcrumb('Français 2', 'S2')">
        <div class="card-title">Français 2</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Anglais 2', 'S2')">
        <div class="card-title">Anglais 2</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('GEM', 'S2')">
        <div class="card-title">GEM</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('GAB', 'S2')">
        <div class="card-title">GAB</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('PPV', 'S2')">
        <div class="card-title">PPV</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('TIC', 'S2')">
        <div class="card-title">TIC</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('STA', 'S2')">
        <div class="card-title">STA</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('PSA', 'S2')">
        <div class="card-title">PSA</div>
      </div>
    </div>
  </section>

  <!-- PPV Subjects (S3) -->
  <section id="subjectsPPV">
    <h2 class="section-title">PPV (S3) - Sélectionnez une matière</h2>
    <div class="grid">
      <div class="card" onclick="selectSubjectWithBreadcrumb('Français 3', 'S3')">
        <div class="card-title">Français 3</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Économie et Gestion', 'S3')">
        <div class="card-title">Introduction à l'Économie et la Gestion</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Agronomie', 'S3')">
        <div class="card-title">Principes généraux d'agronomie</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Horticulture', 'S3')">
        <div class="card-title">Principes généraux d'horticulture</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Pesticides', 'S3')">
        <div class="card-title">Introduction aux pesticides agricoles</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Entomologie', 'S3')">
        <div class="card-title">Entomologie 1 et Nematologie 1</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Science des Sols', 'S3')">
        <div class="card-title">Introduction à la science des sols</div>
      </div>
      <div class="card" onclick="selectSubjectWithBreadcrumb('Science des Plantes', 'S3')">
        <div class="card-title">Introduction à la science des plantes</div>
      </div>
    </div>
  </section>

  <section id="fileTypes">
    <h2 class="section-title" id="fileTypesTitle">Types de fichiers disponibles</h2>
    <div class="grid" id="fileTypesGrid"></div>
  </section>

  <section id="filesList">
    <h2 class="section-title" id="filesListTitle">Fichiers disponibles</h2>
    <div class="file-list-container" id="fileListContainer"></div>
  </section>

  <section id="searchResults">
    <h2 class="section-title">Résultats de recherche</h2>
    <div class="file-list-container" id="searchResultsContainer"></div>
  </section>
</div>

<script>
// Data structure for files
let currentSubject = '';
let currentSemester = '';
let breadcrumbList = [];

// Sample files data - you can add more files here
const filesData = {
  // S1 Subjects
  'Math': { 
    'TD': [], 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'Physique': { 
    'TD': [], 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'Chimie': { 
    'TD': [], 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'Anglais': { 
    'TD': [], 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'Français': { 
    'TD': [], 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'Statistique': { 
    'TD': [], 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'Biologie': { 
    'Cours': [], 
    'Devoirs': [], 
    'Examens': []
  },
  'Microbiologie': { 
    'Cours': [], 
    'Devoirs': [], 
    'Examens': []
  },
  'Génétique': { 
    'Cours': [], 
    'TD': [], 
    'Devoirs': [], 
    'Examens': []
  },
  'Informatique': { 
    'TD': [], 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },

  // S2 Subjects
  'Français 2': { 
    'TD': [], 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'Anglais 2': { 
    'TD': [], 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'GEM': {
    'Dessin': {
      'Cours': [],
      'TD': [],
      'Devoirs': [],
      'Examens': []
    },
    'Électricité': {
      'Cours': [],
      'TD': [],
      'Devoirs': [],
      'Examens': []
    }
  },
  'GAB': { 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'PPV': { 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'TIC': { 
    'TD': [], 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'STA': { 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'PSA': { 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },

  // S3 PPV Subjects
  'Français 3': { 
    'TD': [], 
    'Devoirs': [], 
    'Examens': []
  },
  'Économie et Gestion': { 
    'TD': [], 
    'Devoirs': [], 
    'Examens': []
  },
  'Agronomie': { 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'Horticulture': { 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'Pesticides': { 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'Entomologie': { 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  },
  'Science des Sols': { 
    'Devoirs': [], 
    'Examens': [],
    'Cours': ["pédologie1.pdf"]
  },
  'Science des Plantes': { 
    'Devoirs': [], 
    'Examens': [],
    'Cours': []
  }
};

// Initialize the application
document.addEventListener('DOMContentLoaded', function() {
  // Add event listener for search input
  document.getElementById('searchInput').addEventListener('keyup', function(event) {
    if (event.key === 'Enter') {
      performSearch();
    }
  });

  // Handle browser back button
  window.addEventListener('popstate', function(event) {
    if (breadcrumbList.length > 1) {
      breadcrumbList.pop();
      updateBreadcrumb();
      const lastSection = breadcrumbList[breadcrumbList.length - 1];
      let sectionId = lastSection.id;
      if (sectionId.startsWith('subject-') || sectionId.startsWith('gem-') || sectionId.startsWith('dept-')) sectionId = 'fileTypes';
      showSection(sectionId);
    } else {
      goHome();
    }
  });
});

// Navigation functions
function showSectionWithBreadcrumb(id, name) {
  if (!breadcrumbList.find(b => b.id === id)) {
    breadcrumbList.push({id: id, name: name});
  }
  updateBreadcrumb();
  showSection(id);
  
  // Update browser history
  window.history.pushState({section: id}, '', `#${id}`);
}

function selectSubjectWithBreadcrumb(subject, semester) {
  currentSubject = subject;
  currentSemester = semester;
  const id = 'subject-' + subject;
  if (!breadcrumbList.find(b => b.id === id)) {
    breadcrumbList.push({id: id, name: subject});
  }
  updateBreadcrumb();
  
  if (subject === 'GEM' && semester === 'S2') {
    showSection('gemParts');
  } else {
    showSection('fileTypes');
    updateFileTypesGrid();
  }
  
  // Update browser history
  window.history.pushState({section: 'fileTypes'}, '', `#${id}`);
}

function selectDepartmentWithBreadcrumb(department) {
  const id = 'dept-' + department;
  if (!breadcrumbList.find(b => b.id === id)) {
    breadcrumbList.push({id: id, name: department});
  }
  updateBreadcrumb();
  
  if (department === 'PPV') {
    showSection('subjectsPPV');
  } else {
    // For other departments, show coming soon message
    showComingSoon(department + ' (S3)');
  }
  
  // Update browser history
  window.history.pushState({section: id}, '', `#${id}`);
}

function selectGEMAspect(aspect) {
  currentSubject = 'GEM';
  const id = 'gem-' + aspect;
  if (!breadcrumbList.find(b => b.id === id)) {
    breadcrumbList.push({id: id, name: aspect});
  }
  updateBreadcrumb();
  showSection('fileTypes');
  updateFileTypesGrid();
  
  // Update browser history
  window.history.pushState({section: 'fileTypes'}, '', `#${id}`);
}

function updateFileTypesGrid() {
  const grid = document.getElementById('fileTypesGrid');
  const title = document.getElementById('fileTypesTitle');
  
  if (currentSubject === 'GEM' && currentSemester === 'S2') {
    const currentAspect = breadcrumbList[breadcrumbList.length - 1].name;
    title.textContent = `GEM - ${currentAspect} - Types de fichiers`;
    grid.innerHTML = '';
    
    const aspectFiles = filesData['GEM'][currentAspect];
    for (const type in aspectFiles) {
      const div = document.createElement('div');
      div.className = 'card';
      
      div.innerHTML = `
        <div class="card-title">${type}</div>
      `;
      div.onclick = () => showFiles(type);
      grid.appendChild(div);
    }
  } else {
    title.textContent = `${currentSubject} - Types de fichiers disponibles`;
    grid.innerHTML = '';
    const subjectFiles = filesData[currentSubject];
    
    for (const type in subjectFiles) {
      const div = document.createElement('div');
      div.className = 'card';
      
      div.innerHTML = `
        <div class="card-title">${type}</div>
      `;
      div.onclick = () => showFiles(type);
      grid.appendChild(div);
    }
  }
}

function updateBreadcrumb() {
  const container = document.getElementById('breadcrumbContent');
  container.innerHTML = '';
  
  // Always show home button
  const homeSpan = document.createElement('span');
  homeSpan.innerHTML = '<i class="fas fa-home"></i> Accueil';
  homeSpan.onclick = goHome;
  container.appendChild(homeSpan);
  
  // Add other breadcrumbs
  breadcrumbList.forEach((b, index) => {
    const span = document.createElement('span');
    span.textContent = b.name;
    span.onclick = () => {
      breadcrumbList = breadcrumbList.slice(0, index + 1);
      updateBreadcrumb();
      let sectionId = b.id;
      if (sectionId.startsWith('subject-') || sectionId.startsWith('gem-') || sectionId.startsWith('dept-')) sectionId = 'fileTypes';
      showSection(sectionId);
    };
    container.appendChild(span);
  });
  
  // Show/hide back button
  const backButton = document.querySelector('.back-button');
  backButton.style.display = breadcrumbList.length > 1 ? 'block' : 'none';
}

// Show sections and files
function showSection(id) {
  document.querySelectorAll("section").forEach(s => s.classList.remove("active"));
  const sec = document.getElementById(id);
  if(sec) sec.classList.add("active");
  
  // Scroll to top when changing sections
  window.scrollTo(0, 0);
}

function goHome() {
  breadcrumbList = [];
  updateBreadcrumb();
  showSection('years');
  window.history.pushState({section: 'years'}, '', '#years');
}

function goBack() {
  if (breadcrumbList.length > 1) {
    breadcrumbList.pop();
    updateBreadcrumb();
    const lastSection = breadcrumbList[breadcrumbList.length - 1];
    let sectionId = lastSection.id;
    if (sectionId.startsWith('subject-') || sectionId.startsWith('gem-') || sectionId.startsWith('dept-')) sectionId = 'fileTypes';
    showSection(sectionId);
    window.history.back();
  } else {
    goHome();
  }
}

function showFiles(type) {
  const container = document.getElementById('fileListContainer');
  const title = document.getElementById('filesListTitle');
  
  if (currentSubject === 'GEM' && currentSemester === 'S2') {
    const currentAspect = breadcrumbList[breadcrumbList.length - 1].name;
    title.textContent = `GEM - ${currentAspect} - ${type}`;
    container.innerHTML = '';
    
    const files = filesData['GEM'][currentAspect][type];
    if (files && files.length > 0) {
      files.forEach(file => {
        const fileItem = createFileItem(file, type);
        container.appendChild(fileItem);
      });
    } else {
      container.innerHTML = `
        <div class="empty-state">
          <i class="fas fa-folder-open"></i>
          <h3>Aucun fichier disponible</h3>
          <p>Il n'y a pas encore de fichiers pour ${type} en GEM - ${currentAspect}.</p>
        </div>
      `;
    }
  } else {
    title.textContent = `${currentSubject} - ${type}`;
    container.innerHTML = '';
    
    const files = filesData[currentSubject][type];
    if (files && files.length > 0) {
      files.forEach(file => {
        const fileItem = createFileItem(file, type);
        container.appendChild(fileItem);
      });
    } else {
      container.innerHTML = `
        <div class="empty-state">
          <i class="fas fa-folder-open"></i>
          <h3>Aucun fichier disponible</h3>
          <p>Il n'y a pas encore de fichiers pour ${type} en ${currentSubject}.</p>
        </div>
      `;
    }
  }
  showSection('filesList');
}

function createFileItem(fileName, category) {
  const li = document.createElement('div');
  li.className = 'file-item';
  
  // Determine file icon based on extension
  let fileIcon = 'fas fa-file';
  if (fileName.toLowerCase().includes('.pdf')) fileIcon = 'fas fa-file-pdf';
  if (fileName.toLowerCase().includes('.doc')) fileIcon = 'fas fa-file-word';
  if (fileName.toLowerCase().includes('.ppt')) fileIcon = 'fas fa-file-powerpoint';
  if (fileName.toLowerCase().includes('.xls')) fileIcon = 'fas fa-file-excel';
  
  li.innerHTML = `
    <div class="file-info">
      <i class="${fileIcon} file-icon"></i>
      <div class="file-name">${fileName}</div>
    </div>
    <div class="file-actions">
      <button class="file-action" onclick="downloadFile('${fileName}')">
        <i class="fas fa-download"></i>
      </button>
    </div>
  `;
  
  li.onclick = () => openFile(fileName);
  return li;
}

function openFile(fileName) {
  alert(`Ouverture du fichier: ${fileName}\n\nDans une application réelle, ce fichier serait téléchargé ou ouvert dans une visionneuse.`);
}

function downloadFile(fileName) {
  alert(`Téléchargement du fichier: ${fileName}\n\nDans une application réelle, ce fichier serait téléchargé sur votre appareil.`);
}

function performSearch() {
  const searchTerm = document.getElementById('searchInput').value.trim().toLowerCase();
  
  if (searchTerm === '') {
    alert('Veuillez entrer un terme de recherche.');
    return;
  }
  
  const resultsContainer = document.getElementById('searchResultsContainer');
  resultsContainer.innerHTML = '';
  
  let foundResults = false;
  
  // Search for subjects matching the search term
  for (const subject in filesData) {
    if (subject.toLowerCase().includes(searchTerm)) {
      foundResults = true;
      
      // Create a header for the subject
      const subjectHeader = document.createElement('h3');
      subjectHeader.className = 'search-category';
      subjectHeader.textContent = subject;
      resultsContainer.appendChild(subjectHeader);
      
      // Collect all files for this subject
      const subjectFiles = filesData[subject];
      let totalFiles = 0;
      
      for (const category in subjectFiles) {
        if (subject === 'GEM') {
          // Handle GEM aspects
          for (const aspect in subjectFiles) {
            for (const fileType in subjectFiles[aspect]) {
              const files = subjectFiles[aspect][fileType];
              files.forEach(file => {
                totalFiles++;
                const resultItem = createSearchResultItem(file, `GEM - ${aspect}`, fileType);
                resultsContainer.appendChild(resultItem);
              });
            }
          }
        } else {
          // Handle regular categories
          const files = subjectFiles[category];
          files.forEach(file => {
            totalFiles++;
            const resultItem = createSearchResultItem(file, subject, category);
            resultsContainer.appendChild(resultItem);
          });
        }
      }
      
      // Add a summary for the subject
      const summaryDiv = document.createElement('div');
      summaryDiv.style.padding = '0.5rem 1rem';
      summaryDiv.style.fontStyle = 'italic';
      summaryDiv.style.color = 'var(--text-light)';
      summaryDiv.textContent = `${totalFiles} fichier(s) trouvé(s) pour ${subject}`;
      resultsContainer.appendChild(summaryDiv);
    }
  }
  
  if (!foundResults) {
    resultsContainer.innerHTML = `
      <div class="empty-state">
        <i class="fas fa-search"></i>
        <h3>Aucun résultat trouvé</h3>
        <p>Aucune matière ne correspond à votre recherche pour "${searchTerm}".</p>
      </div>
    `;
  }
  
  showSection('searchResults');
}

function createSearchResultItem(fileName, subject, category) {
  const div = document.createElement('div');
  div.className = 'file-item';
  
  let fileIcon = 'fas fa-file';
  if (fileName.toLowerCase().includes('.pdf')) fileIcon = 'fas fa-file-pdf';
  
  div.innerHTML = `
    <div class="file-info">
      <i class="${fileIcon} file-icon"></i>
      <div>
        <div class="file-name">${fileName}</div>
        <div style="font-size: 0.8rem; color: var(--text-light);">${subject} - ${category}</div>
      </div>
    </div>
    <div class="file-actions">
      <button class="file-action" onclick="downloadFile('${fileName}')">
        <i class="fas fa-download"></i>
      </button>
    </div>
  `;
  
  div.onclick = () => openFile(fileName);
  return div;
}

function showComingSoon(section) {
  alert(`Plus des contenus seront ajoutées bientôt pour ${section}.\n\nRevenez prochainement pour découvrir les nouvelles ressources.`);
}
</script>

</body>
</html>